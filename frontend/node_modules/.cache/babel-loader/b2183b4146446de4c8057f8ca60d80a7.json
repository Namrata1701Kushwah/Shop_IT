{"ast":null,"code":"import _slicedToArray from\"/home/ibm/shopit/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Fragment,useEffect,useState}from\"react\";import MetaData from\"../layouts/MetaData\";import{useAlert}from\"react-alert\";import{useDispatch,useSelector}from\"react-redux\";import{updateProfile,loadUser,clearErrors}from'../../actions/userActions';import{UPDATE_PROFILE_RESET}from\"../../constants/userConstants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UpdateProfile=function UpdateProfile(_ref){var history=_ref.history;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),email=_useState4[0],setEmail=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),avatar=_useState6[0],setAvatar=_useState6[1];var _useState7=useState('/images/default_avatar.jpg'),_useState8=_slicedToArray(_useState7,2),avatarPreview=_useState8[0],setAvatarPreview=_useState8[1];var alert=useAlert();var dispatch=useDispatch();var _useSelector=useSelector(function(state){return state.auth;}),user=_useSelector.user;var _useSelector2=useSelector(function(state){return state.user;}),error=_useSelector2.error,isUpdated=_useSelector2.isUpdated,loading=_useSelector2.loading;useEffect(function(){if(user){setName(user.name);setEmail(user.email);setAvatarPreview(user.avatar.url);}if(error){alert.error(error);dispatch(clearErrors());}if(isUpdated){alert.success('user updated sucessfully');dispatch(loadUser());history.push('/me');dispatch({type:UPDATE_PROFILE_RESET});}},[dispatch,loading,error,history,isUpdated]);var submitHandler=function submitHandler(e){e.preventDefault();var formData=new FormData();formData.set('name',name);formData.set('email',email);formData.set('avatar',avatar);dispatch(updateProfile(formData));};var onChange=function onChange(e){var reader=new FileReader();reader.onload=function(){if(reader.readyState===2){setAvatarPreview(reader.result);setAvatar(reader.result);}};reader.readAsDataURL(e.target.files[0]);};return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MetaData,{title:'update profile'}),/*#__PURE__*/_jsx(\"div\",{className:\"row wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-10 col-lg-5\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"shadow-lg\",onSubmit:submitHandler,encType:\"multipart/form-data\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mt-2 mb-5\",children:\"Update Profile\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email_field\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"name\",id:\"name_field\",className:\"form-control\",name:\"name\",value:name,onChange:function onChange(e){return setName(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email_field\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email_field\",className:\"form-control\",name:\"email\",value:email,onChange:function onChange(e){return setEmail(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"avatar_upload\",children:\"Avatar\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"figure\",{className:\"avatar mr-3 item-rtl\",children:/*#__PURE__*/_jsx(\"img\",{src:avatarPreview,className:\"rounded-circle\",alt:\"Avatar Preview\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"custom-file\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"avatar\",className:\"custom-file-input\",id:\"customFile\",accept:\"image/*\",onChange:onChange}),/*#__PURE__*/_jsx(\"label\",{className:\"custom-file-label\",htmlFor:\"customFile\",children:\"Choose Avatar\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn update-btn btn-block mt-4 mb-3\",disabled:loading?true:false,children:\"Update\"})]})})})]});};export default UpdateProfile;","map":{"version":3,"names":["Fragment","useEffect","useState","MetaData","useAlert","useDispatch","useSelector","updateProfile","loadUser","clearErrors","UPDATE_PROFILE_RESET","UpdateProfile","history","name","setName","email","setEmail","avatar","setAvatar","avatarPreview","setAvatarPreview","alert","dispatch","state","auth","user","error","isUpdated","loading","url","success","push","type","submitHandler","e","preventDefault","formData","FormData","set","onChange","reader","FileReader","onload","readyState","result","readAsDataURL","target","files","value"],"sources":["/home/ibm/shopit/frontend/src/components/user/UpdateProfile.js"],"sourcesContent":["import { Fragment, useEffect, useState } from \"react\";\n\nimport MetaData from \"../layouts/MetaData\";\n\nimport { useAlert } from \"react-alert\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { updateProfile, loadUser, clearErrors } from '../../actions/userActions';\nimport { UPDATE_PROFILE_RESET } from \"../../constants/userConstants\";\n\n\nconst UpdateProfile = ({ history }) => {\n    const [name, setName] = useState('')\n    const [email, setEmail] = useState('')\n    const [avatar, setAvatar] = useState('')\n    const [avatarPreview, setAvatarPreview] = useState('/images/default_avatar.jpg')\n\n    const alert = useAlert();\n\n    const dispatch = useDispatch();\n\n    const { user } = useSelector(state => state.auth)\n    const { error, isUpdated, loading } = useSelector(state => state.user)\n\n    useEffect(() => {\n\n        if (user) {\n            setName(user.name);\n            setEmail(user.email);\n            setAvatarPreview(user.avatar.url)\n        }\n\n\n        if (error) {\n            alert.error(error)\n            dispatch(clearErrors());\n        }\n\n        if (isUpdated) {\n            alert.success('user updated sucessfully')\n            dispatch(loadUser());\n\n            history.push('/me')\n\n            dispatch({\n                type: UPDATE_PROFILE_RESET\n            })\n        }\n\n    }, [dispatch, loading, error, history, isUpdated])\n\n    const submitHandler = (e) => {\n        e.preventDefault();\n\n        const formData = new FormData();\n        formData.set('name', name);\n        formData.set('email', email);\n        formData.set('avatar', avatar);\n\n        dispatch(updateProfile(formData))\n    }\n\n    const onChange = e => {\n\n\n        const reader = new FileReader();\n\n        reader.onload = () => {\n            if (reader.readyState === 2) {\n                setAvatarPreview(reader.result)\n                setAvatar(reader.result)\n            }\n        }\n\n        reader.readAsDataURL(e.target.files[0])\n\n\n    }\n    return (\n        <Fragment>\n            <MetaData title={'update profile'} />\n            <div className=\"row wrapper\">\n                <div className=\"col-10 col-lg-5\">\n                    <form className=\"shadow-lg\" onSubmit={submitHandler} encType='multipart/form-data'>\n                        <h1 className=\"mt-2 mb-5\">Update Profile</h1>\n\n                        <div className=\"form-group\">\n                            <label htmlFor=\"email_field\">Name</label>\n                            <input \n\t\t\t\t\t\t\t\ttype=\"name\" \n\t\t\t\t\t\t\t\tid=\"name_field\" \n\t\t\t\t\t\t\t\tclassName=\"form-control\"\n                                name='name'\n                                value={name}\n                                onChange={(e)=>setName(e.target.value)}\n                            />\n                        </div>\n\n                        <div className=\"form-group\">\n                            <label htmlFor=\"email_field\">Email</label>\n                            <input\n                                type=\"email\"\n                                id=\"email_field\"\n                                className=\"form-control\"\n                                name='email'\n                                value={email}\n                                onChange={(e)=>setEmail(e.target.value)}\n                            />\n                        </div>\n\n                        <div className='form-group'>\n                            <label htmlFor='avatar_upload'>Avatar</label>\n                            <div className='d-flex align-items-center'>\n                                <div>\n                                    <figure className='avatar mr-3 item-rtl'>\n                                        <img\n                                            src={avatarPreview}\n                                            className='rounded-circle'\n                                            alt='Avatar Preview'\n                                        />\n                                    </figure>\n                                </div>\n                                <div className='custom-file'>\n                                    <input\n                                        type='file'\n                                        name='avatar'\n                                        className='custom-file-input'\n                                        id='customFile'\n                                        accept=\"image/*\"\n                                        onChange={onChange}\n                                    />\n                                    <label className='custom-file-label' htmlFor='customFile'>\n                                        Choose Avatar\n                                </label>\n                                </div>\n                            </div>\n                        </div>\n\n                        <button type=\"submit\" className=\"btn update-btn btn-block mt-4 mb-3\"\n                          disabled={loading ? true : false} >Update</button>\n                    </form>\n                </div>\n            </div>\n\n        </Fragment>\n    )\n}\n\n\nexport default UpdateProfile;"],"mappings":"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"},"metadata":{},"sourceType":"module"}